---
title: 日常-2020.7.16
date: 2020-07-16 09:52:01
categories: 日常
---

## 编译时的bug解决

1. cnpm install  版本不匹配
2. 下载匹配版本 1.4.6
3. mpvue-loader版本 下载1.1.4
4. node-sass文件夹下缺少vender目录，新建 vender 文件夹.然后运行,npm rebuild node-sass --save-dev
5. 修改 mpvue-template-compiler/build.js 4675行，converFor函数里添加如下代码

```js
let temp = key.split('.')
if (temp.length === 2) {
   key = temp[1]
}
```

**根本原因是install时根本没有按照package-lock.json中的版本去执行，只能手动安装相应版本**

<!--more-->

## 什么是nrm和npm

nrm 是一个 npm 源管理器，允许你快速地在 npm源间切换。

### nrm安装

```
npm install -g nrm
```

* 查看可选源：`nrm ls`
* 查看当前使用源：`nrm current`
* 切换源：`nrm use taobao`

之后再使用npm安装命令就是使用的淘宝源

## ^符号标识版本号

| ^2.5.2 | 2.5.2 <= version < 3.0.0 |
| ------ | ------------------------ |
| ^0.2.3 | 0.2.3 <= version < 0.3.0 |
| ^0.0.3 | 0.0.3 <= version < 0.0.4 |

首位不为0的加1

## package.json和package-lock.json

npm描述模块信息的文件就是 package.json ，npm  install会根据package.json安装依赖

每次执行完npm install之后会对应生成package-lock文件，该文件记录了上一次安装的具体的版本号。

```
原来的 package.json 文件只能锁定大版本，也就是版本号的第一位，并不能锁定后面的小版本，你每次npm install都是拉取的该大版本下的最新的版本，为了稳定性考虑我们几乎是不敢随意升级依赖包的，这将导致多出来很多工作量，测试/适配等，所以package-lock.json文件出来了，当你每次安装一个依赖的时候就锁定在你安装的这个版本。
```

当文件中存在package-lock.json时，执行npm install，node从package.json文件读取模块名称，从package-lock.json文件中获取版本号，然后进行下载或者更新。 

## 运行后台项目

1. npm run dev之后：` Your application is running here: http://10.2.98.163:2333`

```
这个生成的ip地址在config/index.js中配置，为本机ip地址+2333端口号
```

2. 更改本机host 用本地ip 指向 xxx.company-test.cn 通过 xxx.company-test.cn:端口号去访问

```
//host文件
10.2.98.163 xxx.company-test.cn

//访问地址：http://xxx.company-test.cn:2333/
```

为什么要改为xxx.company-test.cn？

```
因为cooike的同源策略，二级域名相同算作同源，这样可以保证用户的登录状态。

我已经在company-test.cn上成功登录了，就已经存在了cooike，此时再用xxx.company-test.cn访问就可以获取登录态
```

