---
title: 日常-2020.4.22
date: 2020-04-22 09:52:01
categories: 日常
---

今天学习一下vue中常见的一些指令。

* v-text / v-html ，v-for，v-on
* v-if / v-else，v-bind，v-model
* v-show / v-if，v-once，v-cloak
* vue的生命周期与钩子函数
* export与import的使用

<!--more-->

## v-text / v-html 

```html
	<div id='app'>

        <div v-text='text'></div>     <!--结果："<h1>111111111</h1>"-->
        <div v-html='text'></div>     <!--结果："111111111"-->

    </div>

    
    <script src='vue.min.js'></script>
    <script>

        let vm = new Vue({
            el:'#app',
            data:{
                text:"<h1>我是h1标题</h1>"
            }
        })

    </script>
```

## v-for

```html
<div id='app'>
        <ul>
            <li v-for='item in items'>{{ item.msg }}</li> <!--结果：5个li分别显示12345-->
        </ul>
</div>

<script>
        let vm = new Vue({
            el:'#app',
            data:{
                items:[
                    { msg:"1" },
                    { msg:"2" },
                    { msg:"3" },
                    { msg:"4" },
                    { msg:"5" }
                ]
            }
        })
</script>
```

## v-on：绑定事件

```html
	<div id='app'>
        <button v-on:click='add'>点我</button>  <!--结果：弹窗你好-->
        <button @click='add'>点我</button>
    </div>

	<script>

        let vm = new Vue({
            el:'#app',
            data:{
                add:function(){
                    alert('你好')
                }
            }
        })

    </script>
```

## v-if / v-else

```html
    <div id='app'>
        <div v-if='ifelse'>我是if</div>  <!--值为true显示第一行,值为false显示第二行-->
        <div v-else>我是else</div>
    </div>

<script>

        let vm = new Vue({
            el:'#app',
            data:{
                ifelse:false
            }
        })

    </script>
```

## v-bind：绑定属性 

```html
	<style>
        .active {
            color: #2b84da;
        }
    </style>
 

	<div id='app'>
        <a v-bind:href='bing' v-bind:class="{active: isActive}">点我</a>
        <a :href='bing' :class="{active: isActive}">点我</a>
    </div>

	<script>
        let vm = new Vue({
            el:'#app',
            data:{
                bing: 'https://www.sohu.com/',
            }
        })
    </script>
```

## v-model：双向绑定

```html
    <div id='app'>
        <div>{{ msg }}</div>
        <input type='text' v-model='msg'>   <!--双向绑定-->
    </div>

	<script>
        let vm = new Vue({
            el:'#app',
            data:{
                msg:""
            }
        })
    </script>
```

## v-show / v-if：显示与隐藏

相同点：v-if与v-show都可以动态控制dom元素显示隐藏

不同点：v-if将dom元素整个添加或删除，而v-show隐藏则是为该元素添加css–display:none，dom元素还在。

```html
	<div id='app'>
        <div v-if='isIf'>我是v-if</div>
        <div v-show='isShow'>我是v-show</div>
    </div>

    <script>
        let app = new Vue({
            el:'#app',
            data:{
                isIf:true,
                isShow:false
            }
        })
    </script>
```

## v-once：渲染一次

```html
	<div id='app'>
        <div>{{ msg }}</div>
        <input type='text' v-model='msg'>   
        <div v-once>{{ msg }}</div>       <!--msg值变化，但是显示不变-->
    </div>

	<script>
        let vm = new Vue({
            el:'#app',
            data:{
                msg:""
            }
        })
    </script>
```

## v-cloak：解决闪烁

```html
	<style>
        [v-cloak]{
            display:none
        }
    </style>

	<div id='app'>
        <h1>{{ msg }}</h1>
        <h1 v-cloak> {{ msg }} </h1>   <!--解决闪烁问题-->
    </div
        
	<script>
        let vm = new Vue({
            el:'#app',
            data:{
                msg:"123"
            }
        })
    </script>
```

## 关于vue的生命周期

理解这个之前，我准备去下载一下vue的源码去看一下，new Vue()之后到底发生了哪些事情。

首先去github上搜索vue，下载标上tag的稳定版本。

下载好后，找到`src/core/index.js`,里面这样一行代码

```js
import Vue from './instance/index'
```

找到`instance/index`，里面有这样一个函数

```js
function Vue (options) {
  if (process.env.NODE_ENV !== 'production' &&
    !(this instanceof Vue)
  ) {
    warn('Vue is a constructor and should be called with the `new` keyword')
  }
  this._init(options)
}
```

所以我们在使用`new Vue（）`时就是调用了上面的`function Vue()`里面的过程，从`new Vue()`开始，

> Vue实例有一个完整的生命周期，也就是从开始创建、初始化数据、编译模板、挂载Dom、渲染→更新→渲染、卸载等一系列过程，我们称这是Vue的生命周期。通俗说就是Vue实例从创建到销毁的过程，就是生命周期。 

那我们继续寻找，`this._init()`做了哪些事情呢，找到`init.js`这个文件，找到了如下函数

```js
Vue.prototype._init = function(){}  
```

这个在原型上定义的函数就应该是初始化的过程，函数里有很多，但是我看到了如下代码

```js
	initLifecycle(vm)
    initEvents(vm)
    initRender(vm)
    callHook(vm, 'beforeCreate')
    initInjections(vm) // resolve injections before data/props
    initState(vm)
    initProvide(vm) // resolve provide after data/props
    callHook(vm, 'created')
```

到这里我就明白了，这是按顺序的初始化流程，其中的`callHook`就是钩子函数，我们可以在vue实例的钩子函数中写一些自己的操作，然后就会在这里被调用，如下：

```html
	<script type="text/javascript">
        var vm = new Vue({
            el: "#app",
            template: "<div>hello world</div>",
            beforeCreate: function() {
                console.log("beforeCreate")
            },
            created: function() {
                console.log("created")
            },
            beforeMount: function() {
                console.log(this.$el)
                console.log("beforeMount")
            },
            mounted: function() {
                console.log("mounted")
                console.log(this.$el)
            },
            beforeDestroy: function() {
                console.log("beforeDestroy")
            },
            destroyed: function() {
                console.log("destroyed")
            },
            beforeUpdate: function() {
                console.log("beforeUpdate")
            },
            updated: function() {
                console.log("updated")
            }
        });
    </script>

<!--
输出：
        beforeCreate
        created
        <div id='app'></div>
        beforeMount
        mounted
        <div>hello world</div>
-->
```

下图是官方给的一张图：

![1](https://cn.vuejs.org/images/lifecycle.png)

## export与import的使用

现在有两个文件a.js和b.js

```js
//a.js
export var a = 'my name is a'

//b.js
import {a} from './a.js';
console.log(a)
```

### export多个变量

```js
//a.js
var a1='my name is a1',a2='my name is a2';
export {a1,a2}

//b.js
import {a1,a2} from './a.js';
console.log(a1,a2)
```

### export default 的用法

export 之后加上default意指默认接口的意思，在一个文件里面默认的只能有一个  

```js
//b.js
var b = 'myname is b'
export default b

//a.js
import b from './b.js';
console.log(b)
```

