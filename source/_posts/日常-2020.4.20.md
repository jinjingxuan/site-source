---
title: 日常-2020.4.20
date: 2020-04-20 09:52:01
categories: 日常
---

* mpvue的目录结构
* 关于一些指令的学习
* 成功运行项目
* 什么是开发环境，生产环境，测试环境

<!--more-->

## mpvue的目录结构

这是新建的一个mpvue项目，先来了解一下他的目录结构。

![JMIhY4.png](https://s1.ax1x.com/2020/04/20/JMIhY4.png)

* build：用于项目编译打包的node.js脚本和webpack配置文件，不需要我们去修改
* config：包含了用于开发和生产环境下的不同配置，`dev.env.js`用于开发环境，`prod.env.js`用于生产环境 
* dist：在执行npm run dev后由src编译生成的微信小程序文件。 
* node_modules：项目依赖，这个目录有90M大小，包含了很多模块。
* src：`src`目录是我们主要进行小程序功能编写的地方。 包含如下文件：
  * components：在实际开发中，我们可以尽量将界面上可复用的部分，提取成vue组件放入该目录
  * pages：存放小程序的页面。请遵循每个小程序页面放入一个单独子目录的组织形式
  * utils：可选（可删）。可以将代码中一些公用工具函数组织成模块放入该目录下
  * app.json：小程序一些配置：页面，window，tabBar，items等
  * main.js + App.vue：这两个是入口文件
* static：用于存放各种小程序本地静态资源，如图片、文本文件等。可通过相对路径或绝对路径进行访问 
* package.json：项目的主配置文件，包含了项目的基本描述信息、项目所依赖、以及可执行的脚本信息。
* project.config.json ：小程序项目的配置文件，其中记录了小程序的appid、代码主目录、以及编译选项等

## 关于一些指令的学习

* npm install
* npm run dev
* npm  run build
* npm run build --report

### npm install

`npm install`=`npm i`。在git clone项目的时候，项目文件中并没有 node_modules文件夹，项目的依赖文件可能很大。直接执行，npm会根据package.json配置文件中的依赖配置下载安装。

- `-global`=`-g`，全局安装，安装后的包位于系统预设目录下
-  `--save`=`-S`，安装的包将写入package.json里面的dependencies，dependencies：生产环境需要依赖的库
-  `--save-dev`=`-D`，安装的包将写入packege.json里面的devDependencies，devdependencies：只有开发环境下需要依赖的库

### npm run dev 与 npm  run build

首先在项目中的package.son中找到有如下配置

```
"dev": "node build/dev-server.js wx",
"build": "node build/build.js wx",

//运行”npm run dev”的时候执行的是build/dev-server.js文件，
//运行”npm run build”的时候执行的是build/build.js文件。
```

那我们去看一下bulid文件夹里的这两个文件，此处参考于[这里](<https://www.jb51.net/article/154579.htm> )

（1）npm run dev 执行的文件build/dev-server.js文件，执行了：

- 检查node和npm的版本
- 引入相关插件和配置
- 创建express服务器和webpack编译器
- 配置开发中间件（webpack-dev-middleware）和热重载中间件（webpack-hot-middleware）
- 挂载代理服务和中间件
- 配置静态资源
- 启动服务器监听特定端口
- 自动打开浏览器并打开特定网址

（2）npm run build的时候执行的是build/build.js文件，构建环境下的配置，

> 执行npm run build，实际上执行了build/build.js,通过webpack的一系列配置及插件，将文件打包合并丑化，并创建dist目录，放置编译打包后的文件，这将是未来用在生产环境的包。 

**错误**：在使用`npm run dev`运行项目时，出现了如下错误：

```
Vue packages version mismatch:
- vue@1.0.18
- mpvue-template-compiler@1.4.6

//可见这是版本不匹配的原因，那么我们来下载一个版本使其相同就好了
```

运行`cnpm install vue@1.4.6 --save`，依旧报错

```
Install fail! Error: [vue@1.4.6] Can't find package vue's version: 1.4.6
//找不到1.4.6版本
```

那我们来看一下vue目前有哪些版本，执行`npm view vue versions`

```
//看了一下还真没有1.4.6
//这时候我们运行 cnpm install mpvue-template-compiler@1.0.18 --save
```

安装成功，重新运行`npm run dev`，还是有问题.......

```
No parser and no filepath given, using 'babel' the parser now but this will throw an error in t
he future. Please specify a parser or a filepath so one can be inferred.

//是prettier版本导致的
//Prettier 是一个有见识的代码格式化工具。它通过解析代码并使用自己的规则重新打印它,并考虑最大行长来强制执行一致的样式,并在必要时包装代码。
```

直接输入` cnpm install prettier@~1.12.0 -D  `后再`npm run dev`运行成功。项目中出现dist目录，导入微信开发者工具，项目运行成功~

下面运行`npm run build`,可以看出来文件已经被打包成功。弹出的网页中显示了如下三种size

* Stat size：统计大小
* Parsed size：解析大小
* Gzipped size：压缩大小

## 开发环境，生产环境，测试环境

1：开发环境：项目尚且在编码阶段，我们的代码一般在开发环境中 不会在生产环境中。

2：测试环境：项目完成测试，修改bug阶段

3：生产环境：项目数据前端后台已经跑通，部署之后，有客户使用，访问，就是网站正式运行了

**开发到正式上线的流程：**

应该是先在开发环境 中开发完成，测试环境测试，保证程序没有问题后，再上传到生产环境中。