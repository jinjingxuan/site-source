---
title: 代码规范
date: 2020-09-20 10:27:54
categories: 规范
---

* 使用默认值
* 解构语法
* 删掉注释的代码
* 尽量不用“非”条件句
* 使用Array.includes来处理多个条件
* 多个类似函数
* 使用 && 运算符化简表达式
* 空值合并运算符 '??'
* 代码风格
* 一些技巧

## 使用默认值

```js
// Bad
function createMicrobrewery(name) {
    const brewryName = name || 'Hipster Brew'
    // ...
}

// Good
function createMicrobrewery(name = 'Hipster Brew') {
    // ...
}
```

## 解构语法

**如果参数超过两个，可以使用解构语法，不用考虑参数的顺序**

```js
// Bad
function createMenu(title, body, buttonText, cancellable) {
    // ...
}
// Good
function createMenu({ title, body, buttonText, cancellable }) {
    // ...
}

createMenu({
    title: 'Foo',
    body: 'Bar',
    buttonText: 'Baz',
    cancellable: true
})
```

## 删掉注释的代码

**git存在的意义就是保存你的旧代码，所以注释的代码赶紧删掉吧**

```js
// Bad
doStuff()
// doOtherStuff()
// doSomeMoreStuff()
// doSoMuchStuff()

// Good
doStuff()
```

## 尽量不用“非”条件句

```js
// Bad
function isDOMNodeNotPresent(node) {
    // ...
}

if (!isDOMNodeNotPresent(node)) {
    // ...
}
// Good
function isDOMNodeNotPresent(node) {
    // ...
}

if (isDOMNodeNotPresent(node)) {   // if后面记得加空格
    // ...
}
```

## 使用Array.includes来处理多个条件

```js
function test(fruit) {
    if (fruit == 'apple' || fruit == 'banana') {
        console.log(red)
    }
}
// 如果有更多的红色水果怎么办
function test(fruit) {
    const redFruits = ['apple', 'strawberry', 'cherry']
    if (redFruits.includes(fruit)) {
        console.log(red)
    }
}
```

## 多个类似函数

```js
 update (node, key, attrName) {
    let updateFn = this[attrName + 'Updater']
    updateFn(node, key, attrName)
 }

  textUpdater (node, value, key) {
    // ...
  }

  modelUpdater (node, value, key) {
    // ...
  }
```

## 使用 && 运算符化简表达式

让我们考虑一个具有布尔值和函数的情况。

```js
let isPrime = true;
const startWatching = () => {
    console.log('Started Watching!');
}
```

像下面这样，通过检查布尔值来确定是否调用函数，代码太多了。

```js
if (isPrime) {
    startWatching();
}
```

能否通过 AND（&&）运算符使用简写形式？是的，完全可以避免使用 if 语句。酷吧！

```js
isPrime && startWatching();
```

## 空值合并运算符 '??'

值既不是 `null` 也不是 `undefined` 的表达式称为“已定义的（defined）”。

`a ?? b` 的结果是：

- 如果 `a` 是已定义的，则结果为 `a`，
- 如果 `a` 不是已定义的，则结果为 `b`。
- 如果第一个参数不是 `null/undefined`，则 `??` 返回第一个参数。否则，返回第二个参数。

通常 `??` 的使用场景是，为可能是未定义的变量提供一个默认值。

```js
let user;

alert(user ?? "Anonymous"); // Anonymous
```

### 与 || 比较

它们之间重要的区别是：

- `||` 返回第一个 **真** 值。
- `??` 返回第一个 **已定义的** 值。

```js
let height = 0;

alert(height || 100); // 100
alert(height ?? 100); // 0
```

## 一些技巧

```js
const obj = {
    max(a,b) {
        return Math.max(a,b)
    }
}
// 优化为
const obj = {
    max: Math.max
}


var numbers = [1, 4, 9];
var roots = numbers.map(Math.sqrt);

[1,2,3,4].map(item => {
    return item * 2
})
// 当只有一个 return 时简化为
[1,2,3,4].map(item => item * 2)
```



