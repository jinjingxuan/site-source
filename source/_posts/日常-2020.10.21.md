---
title: 日常-10.21
date: 2020-10-21 10:27:54
categories: 日常
---

* 根据权限动态添加路由列表
* 配置路由meta属性
* application/x-www-form-urlencoded 和 application/json
* git rebase
* 预检请求
* props单向传递
* (0,function)
* parseInt解析字符串

<!--more-->

## 根据权限动态添加路由列表

* 业务场景：不同用户调用权限接口获得的权限是不同的，根据用户权限动态展示路由列表

```js
		 api.getAuditInfo({
             account: username,
         }).then(res => {
             console.log('权限代码:', res)
             // 高级权限：可以查看某一块路由
             if (res.includes('auth0')) {
                 window.authInfo = true
                 // 添加路由
                 this.$router.addRoutes(videoRoutes)
                 this.$router.options.routes.push(...videoRoutes)
             // 普通权限
             } else if (res.includes('auth1') && !res.includes('auth0')) {
                 window.authInfo = false
             // 没有权限时返回
             } else {
                 window.location.href = `
             }
         })
```

## 配置路由meta属性

* 业务场景：同一个组件在不同路由下的展示状态是不同的，这时可以配置路由meta属性来实现

```js
const routes = [
    {
        path: '/audit/video',
        name: '视频管理',
        component: Layout,
        children: [
            {
                path: 'videoList',
                name: '视频列表',
                meta: {
                    noCache: true,
                    cityChange: true,
                },
                component: auditvideoList
            },
            {
                path: 'auditList',
                name: '审核列表',
                // 配置 meta 属性
                meta: {
                    noCache: true,
                    cityDefault: true 
                },
                component: auditList
            }
        ]
    },
    {
        path: '*',
        redirect: '/audit/agent',
        hidden: true
    }
]
```

* 比如说 header 中的一个组件，不同路由页面均展示，只是状态不同

```vue
<template>
    <div v-if="!cityDefault"></div>
	<div v-else ></div>
</template>	
	
<script>
computed: {
        cityDefault() {
            return this.$route.meta.cityDefault;
        }
    },
</script>
```

## application/x-www-form-urlencoded 和 application/json

* application/x-www-form-urlencoded
  * HTTP会将请求参数用key1=val1&key2=val2的方式进行组织，并放到请求实体里面
* application/json
  * JSON 是一种轻量级的数据格式，以“键-值”对的方式组织的数据。这个使用这个类型，需要参数本身就是json格式的数据，参数会被直接放到请求实体里，不进行任何处理。
* 可以参考[Content-Type 详解](https://www.jianshu.com/p/de5845b4c095)

## git rebase

* git rebase -i：合并多次提交记录
* git rebase master：与 merge 的区别是不会有 merge 的 commit，保持干净的提交记录

参考[这一次彻底搞懂 Git Rebase](https://www.codercto.com/a/45325.html)，[完美生活：git rebase -i | Linux 中国](https://zhuanlan.zhihu.com/p/141871803)，[【Git】rebase 用法小结](https://www.jianshu.com/p/4a8f4af4e803)

## 预检请求

* 预检请求会向服务器确认跨域是否允许，服务返回的响应头里有对应字段`Access-Control-Allow-Origin`来给浏览器判断：如果允许，浏览器紧接着发送实际请求；不允许，报错并禁止客户端脚本读取响应相关的任何东西。
* 参考[预检请求 OPTIONS](https://zhuanlan.zhihu.com/p/46405073)

## props单向传递

* 由于props是单向传递，如果在子组件中改变父组件传来的值 vue 会报出警告
* 首先想到的办法是在子组件中声明一个局部变量存储 props 的值，可以改变这个局部变量
* 但是会存在一个问题，如下：

```js
// 子组件
created() {
    this.localData = this.propData
},
    
// 如果这样赋值的话，若父组件中改变 propData 的值，子组件中不会响应式改变，解决办法是
created() {
    this.$set(this, 'localData', this.propData)
},
```

## (0,function)

> 逗号运算符，它将先计算左边的参数，再计算右边的参数值。然后返回最右边参数的值。 

```js
var a = {
  foo: function() {
    console.log(this === window);
  }
};
 
a.foo(); // Returns 'false' in console
(0, a.foo)(); // Returns 'true' in console
```

But, if you were call `(0, a.foo)()`. The expression `(0, a.foo)` will evaluate each of its operands (from left to right) and returns the value of the last operand. In other words, `(0, a.foo)` is equivalent to 

```js
function() {
  console.log(this === window);
} 
```

## parseInt解析字符串

```js
parseInt("10");			//返回 10
parseInt("19",10);		//返回 19 (10+9)
parseInt("11",2);		//返回 3 (2+1)
parseInt("17",8);		//返回 15 (8+7)
parseInt("1f",16);		//返回 31 (16+15)
parseInt("010");		//未定：返回 10 或 8

//BigInt也有转换进制的功能
BigInt("0b"+"10") //2
BigInt("0o"+"10") //8
BigInt("0x"+"10") //16

//那么10进制怎么转换成2进制呢
NumberObject.toString(radix);

//parseInt还具有向下取整的功能
parseInt(2.5) //2
```

