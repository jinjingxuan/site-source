---
title: 日常-2020.4.24
date: 2020-04-24 09:52:01
categories: 日常
---

* 组件化
* 如何注册一个组件（全局，局部）
* .Vue文件也是组件
* Vue项目结构
* 父子组件的通信

<!--more-->

## 组件化

**所谓组件化，就是把页面拆分成多个组件，每个组件依赖的 CSS、JS、模板、图片等资源放在一起开发和维护。** 因为组件是资源独立的，所以组件在系统内部可复用，组件和组件之间可以嵌套，如果项目比较复杂，可以极大简化代码量，并且对后期的需求变更和维护也更加友好。

**vue的组件化**：任何的应用都会被抽象为一棵组件树。

 ![1](https://img-blog.csdnimg.cn/20181220155021919)

## 如何注册一个组件（全局，局部）

* 全局注册：`Vue.component `，所有的Vue实例都可以使用。

```html
	<div id='app'>
        <mycomponent></mycomponent>
    </div>

    <script>

        Vue.component('mycomponent',{
            template:`<div>这是一个自定义组件</div>`,
            data(){
                return{
                    message:'hello world'
                }
            }
        })       
        
        let vm = new Vue({
            el:'#app'
        })

    </script>
```

* 局部注册：在某个Vue实例内注册，只有该实例可以使用

```html
	<div id='app'>
        <mycomponent></mycomponent>
    </div>

    <script>      
        
        let vm = new Vue({
            el:'#app',
            components:{
                'mycomponent':{
                    template: `<div>这是一个自定义的局部组件</div>`
                }
            }
        })

    </script>
```

### 模板只有一个根元素

### 组件中的data必须是函数

> data不能是一个对象，由于JS中对象类型的变量实际上保存的是对象的`引用`，所以当存在多个这样的组件时，会共享数据，导致一个组件中数据的改变会引起其他组件数据的改变。
>
> 而使用一个返回对象的函数，每次使用组件都会创建一个新的对象，这样就不会出现**共享数据**的问题来了。

### 自定义标签的限制

标准HTML中，一些元素中只能放置特定的子元素，另一些元素只能存在于特定的父元素中。 比如table 元素中只能由一个或多个 tr、th 或 td 元素组成。tr 元素定义表格行，th 元素定义表头，td 元素定义表格单元。这时应该用**is**属性

```html
<!--无效-->
<table>
  <my-row>...</my-row>
</table>

<!--正确-->
<table>
  <tr is="my-row"></tr>
</table>
```

## .Vue文件也是组件

每个.vue文件包含三种类型的顶级语言块 <template>, <script> 和 <style>。这三个部分分别代表了 html,js,css 

来看一个最简单的Vue组件，

```vue
<template>                                  <!--template标签内是html-->     
  <div class='page-index'>                  <!--注意里面只有一个根标签-->
    <Header></Header>                       <!--自定义的组件-->
    <div></div>
    <Footer></Footer>                       <!--自定义的组件-->
  </div>
</template>
<script>
import Header from '../components/header.vue'   //引用自定义组件
import Footer from '../components/footer.vue'   //引用自定义组件
export default {                                //export default里面写数据和方法
  components: { Header, Footer },               //组件
  data () {                                     //数据，记得用函数形式
    return {
      list: []
    }
  },
  created () {                                  //钩子函数
    this.getData()
  },
  methods: {                                    //方法
    getData () {
      })
    }
  }
}
</script>
<style>
  .article_list {margin: auto;}
</style>
```

## Vue项目结构

上次构建好项目后，没仔细看，今天来具体看一下

![JB0OlF.png](https://s1.ax1x.com/2020/04/24/JB0OlF.png)



* index.html：首页入口文件，浏览器中显示的页面

```html
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>vuetest</title>
  </head>
  <body>
    <div id="app"></div>
    <!-- built files will be auto injected -->
  </body>
</html>
```

* main.js：项目的核心文件，主要完成了index.html中vue实例的挂载

```js
import Vue from 'vue'            //引入vue组件，才可以进行new Vue
import App from './App'          //引入App组件
import router from './router'    //引入路由组件

Vue.config.productionTip = false

/* eslint-disable no-new */
new Vue({
  el: '#app',
  router,
  components: { App },            //id为app的div中有一个名为App的组件
  template: '<App/>'
})
```

* APP.vue：项目入口文件

```vue
<template>
  <div id="app">
    <img src="./assets/logo.png">
    <router-view/>
  </div>
</template>

<script>
export default {
  name: 'App'
}
</script>

<style>
#app {
  font-family: 'Avenir', Helvetica, Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-align: center;
  color: #2c3e50;
  margin-top: 60px;
}
</style>
```

现在就明显了，`index.html`里的div使用`main.js`中的挂载，去找App.vue这个组件去渲染，那么App.vue里已经有了logo图片 ，那么下面的`<router-view/>`是什么意思呢？

我么去找一下`src/router/index.js `这个文件、

```js
import Vue from 'vue'
import Router from 'vue-router'
import HelloWorld from '@/components/HelloWorld'

Vue.use(Router)

export default new Router({
  routes: [
    {
      path: '/',
      name: 'HelloWorld',
      component: HelloWorld
    }
  ]
})
//在index.js的代码中，建立了路由相关的内容，也就会渲染到app.vue下面的<router-view>中。在index.js中，将helloworld组件发布为路由，换句说，index.js在这里就是将helloword发布为路由
```

helloworld组件就是在图片logo下显示的内容了。

**顺序：index.html->main.js->App.vue->index.js->HelloWorld.vue**

## 父子组件的通信

**父组件通过props属性向下传递数据给子组件，子组件通过events事件给父组件发送消息**

* 子组件需要某个数据，就在内部定义一个`prop`属性，然后父组件把自己的data属性传递给子组件这个属性。 
* 子组件内部发生了什么事情的时候，就通过**自定义事件**来把这个事情涉及到的数据暴露出来，供父组件处理。 